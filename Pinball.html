<html>
<canvas id="theCanvas" width="600" height="600" style="border: 1px solid black"></canvas>
<script>
//finds distance between two points
function distance(x1,y1,x2,y2){
    return Math.sqrt((x1-x2)*(x1-x2)+(y1-y2)*(y1-y2));
}
function Ball(ballX,ballY){
    this.x = ballX;
    this.y = ballY;
    this.dx = Math.random()*2-1;
    this.dy = 0;
    this.update = function(){
        this.x += this.dx;
        this.y += this.dy;
        this.dy += 1;
        for(z=0;z<bumper.length;z++){
            if(distance(this.x,this.y,bumper[z].x,bumper[z].y)<bumperBallDistance){
                angleToBumper = Math.atan2(this.y-bumper[z].y,this.x-bumper[z].x);
                velocityAngle = Math.atan2(this.dy,this.dx);
                velocityMagnitude = Math.sqrt(this.dx*this.dx+this.dy*this.dy)*.3;
                angleDifference = velocityAngle-angleToBumper;
                velocityAngle = velocityAngle-angleDifference;
                this.x = bumper[z].x+Math.cos(angleToBumper)*(bumperBallDistance+1);
                this.y = bumper[z].y+Math.sin(angleToBumper)*(bumperBallDistance+1);
                this.dx = velocityMagnitude*Math.cos(velocityAngle);
                this.dy = velocityMagnitude*Math.sin(velocityAngle);
            }
        }
        if(this.y>=cnvs.height+ballRadius){
            this.x = ballRadius+(cnvs.width-ballRadius*2)*Math.random();
            this.y = 0;
            this.dx = 0;
            this.dy = 0;
        }
        if(this.x<ballRadius){
            this.dx = -this.dx;
            this.x = ballRadius;
        }
        if(this.x>cnvs.width-ballRadius){
            this.dx = -this.dx;
            this.x = cnvs.width-ballRadius;
        }
    }
}
function Bumper(bumperX,bumperY){
    this.x = bumperX;
    this.y = bumperY;
}
function redrawEverything(){
    //Black out screen
    ctx.fillStyle = "black";
    ctx.fillRect(0,0,cnvs.width,cnvs.height);
    //Draw balls
    ctx.fillStyle = "white";
    for(a=0;a<ball.length;a++){
        ctx.beginPath();
        ctx.arc(ball[a].x,ball[a].y,ballRadius,0,Math.PI*2);
        ctx.fill();
    }
    ctx.fillStyle = "blue";
    for(a=0;a<bumper.length;a++){
        ctx.beginPath();
        ctx.arc(bumper[a].x,bumper[a].y,bumperRadius,0,Math.PI*2);
        ctx.fill();
    }
}
cnvs = document.getElementById("theCanvas");
ctx = cnvs.getContext("2d");
ballRadius = 10;
bumperRadius = 15;
bumperBallDistance = ballRadius+bumperRadius;
ball = [];
for(a=0;a<30;a++){
    ball.push(new Ball(ballRadius+(cnvs.width-ballRadius*2)*Math.random(),0));
}
bumper = [];
for(a=0;a<10;a++){
    bumper.push(new Bumper(bumperRadius+(cnvs.width-bumperRadius*2)*Math.random(),Math.random()*(cnvs.height-200)+100))
}
setInterval(function(){
    for(a=0;a<ball.length;a++){
        ball[a].update();
    }
    redrawEverything();
},33)
</script>
</html>